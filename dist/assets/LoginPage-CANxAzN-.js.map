{"version":3,"file":"LoginPage-CANxAzN-.js","sources":["../../src/pages/LoginPage.tsx"],"sourcesContent":["import { useState } from \"react\";\nimport { Link, useLocation, useNavigate } from \"react-router-dom\";\nimport { authApi } from \"../api/auth.api\";\nimport { useAppDispatch } from \"../app/hooks\";\nimport { setAuthenticated } from \"../app/authSlice\";\nimport { useLogin } from \"../features/auth/hooks/useAuthMutations\";\nimport { useToast } from \"../components/ui/ToastProvider\";\nimport { normalizeApiError } from \"../api/errors\";\nimport { validateEmail, validatePassword } from \"../utils/validation\";\n\ntype LocationState = {\n  from?: { pathname?: string };\n};\n\nexport default function LoginPage() {\n  const navigate = useNavigate();\n  const location = useLocation();\n  const dispatch = useAppDispatch();\n  const { pushToast } = useToast();\n  const loginMutation = useLogin();\n\n  const [email, setEmail] = useState(\"\");\n  const [password, setPassword] = useState(\"\");\n  const [error, setError] = useState(\"\");\n\n  const handleSubmit = async (event: React.FormEvent<HTMLFormElement>) => {\n    event.preventDefault();\n    const emailErr = validateEmail(email);\n    const passErr = validatePassword(password);\n    if (emailErr || passErr) {\n      setError(emailErr || passErr);\n      return;\n    }\n\n    setError(\"\");\n    try {\n      await loginMutation.mutateAsync({ email, password });\n      const me = await authApi.me();\n      dispatch(setAuthenticated({ userId: me.userId }));\n      pushToast(\"Logged in successfully\", \"success\");\n      const nextPath = (location.state as LocationState)?.from?.pathname || \"/\";\n      navigate(nextPath, { replace: true });\n    } catch (err) {\n      setError(normalizeApiError(err).message);\n    }\n  };\n\n  return (\n    <div>\n      <h2 className=\"text-2xl font-semibold text-slate-900\">Welcome back</h2>\n      <p className=\"mt-1 text-sm text-slate-600\">Sign in to access your legal vault.</p>\n\n      <form className=\"mt-6 space-y-4\" onSubmit={handleSubmit}>\n        <label className=\"block\">\n          <span className=\"mb-1 block text-sm font-medium text-slate-700\">Email</span>\n          <input\n            aria-label=\"Email address\"\n            className=\"w-full rounded-lg border border-slate-300 px-3 py-2 text-sm focus:border-brand-500 focus:outline-none focus:ring-2 focus:ring-brand-100\"\n            type=\"email\"\n            autoComplete=\"email\"\n            value={email}\n            onChange={(event) => setEmail(event.target.value)}\n          />\n        </label>\n        <label className=\"block\">\n          <span className=\"mb-1 block text-sm font-medium text-slate-700\">Password</span>\n          <input\n            aria-label=\"Password\"\n            className=\"w-full rounded-lg border border-slate-300 px-3 py-2 text-sm focus:border-brand-500 focus:outline-none focus:ring-2 focus:ring-brand-100\"\n            type=\"password\"\n            autoComplete=\"current-password\"\n            value={password}\n            onChange={(event) => setPassword(event.target.value)}\n          />\n        </label>\n        {error ? <p className=\"text-sm text-rose-600\">{error}</p> : null}\n        <button\n          className=\"w-full rounded-lg bg-brand-500 px-4 py-2 text-sm font-medium text-white hover:bg-brand-700 disabled:opacity-70\"\n          type=\"submit\"\n          disabled={loginMutation.isPending}\n        >\n          {loginMutation.isPending ? \"Signing in...\" : \"Sign in\"}\n        </button>\n      </form>\n\n      <div className=\"mt-4 flex justify-between text-sm\">\n        <Link className=\"text-brand-700 hover:underline\" to=\"/register\">\n          Create account\n        </Link>\n        <Link className=\"text-brand-700 hover:underline\" to=\"/forgot-password\">\n          Forgot password?\n        </Link>\n      </div>\n    </div>\n  );\n}\n"],"names":["LoginPage","navigate","useNavigate","location","useLocation","dispatch","useAppDispatch","pushToast","useToast","loginMutation","useLogin","email","setEmail","useState","password","setPassword","error","setError","handleSubmit","event","emailErr","validateEmail","passErr","validatePassword","me","authApi","setAuthenticated","nextPath","_b","_a","err","normalizeApiError","jsx","jsxs","Link"],"mappings":"iQAcA,SAAwBA,GAAY,CAClC,MAAMC,EAAWC,EAAA,EACXC,EAAWC,EAAA,EACXC,EAAWC,EAAA,EACX,CAAE,UAAAC,CAAA,EAAcC,EAAA,EAChBC,EAAgBC,EAAA,EAEhB,CAACC,EAAOC,CAAQ,EAAIC,EAAAA,SAAS,EAAE,EAC/B,CAACC,EAAUC,CAAW,EAAIF,EAAAA,SAAS,EAAE,EACrC,CAACG,EAAOC,CAAQ,EAAIJ,EAAAA,SAAS,EAAE,EAE/BK,EAAe,MAAOC,GAA4C,SACtEA,EAAM,eAAA,EACN,MAAMC,EAAWC,EAAcV,CAAK,EAC9BW,EAAUC,EAAiBT,CAAQ,EACzC,GAAIM,GAAYE,EAAS,CACvBL,EAASG,GAAYE,CAAO,EAC5B,MACF,CAEAL,EAAS,EAAE,EACX,GAAI,CACF,MAAMR,EAAc,YAAY,CAAE,MAAAE,EAAO,SAAAG,EAAU,EACnD,MAAMU,EAAK,MAAMC,EAAQ,GAAA,EACzBpB,EAASqB,EAAiB,CAAE,OAAQF,EAAG,MAAA,CAAQ,CAAC,EAChDjB,EAAU,yBAA0B,SAAS,EAC7C,MAAMoB,IAAYC,GAAAC,EAAA1B,EAAS,QAAT,YAAA0B,EAAkC,OAAlC,YAAAD,EAAwC,WAAY,IACtE3B,EAAS0B,EAAU,CAAE,QAAS,EAAA,CAAM,CACtC,OAASG,EAAK,CACZb,EAASc,EAAkBD,CAAG,EAAE,OAAO,CACzC,CACF,EAEA,cACG,MAAA,CACC,SAAA,CAAAE,EAAAA,IAAC,KAAA,CAAG,UAAU,wCAAwC,SAAA,eAAY,EAClEA,EAAAA,IAAC,IAAA,CAAE,UAAU,8BAA8B,SAAA,sCAAmC,EAE9EC,EAAAA,KAAC,OAAA,CAAK,UAAU,iBAAiB,SAAUf,EACzC,SAAA,CAAAe,EAAAA,KAAC,QAAA,CAAM,UAAU,QACf,SAAA,CAAAD,EAAAA,IAAC,OAAA,CAAK,UAAU,gDAAgD,SAAA,QAAK,EACrEA,EAAAA,IAAC,QAAA,CACC,aAAW,gBACX,UAAU,0IACV,KAAK,QACL,aAAa,QACb,MAAOrB,EACP,SAAWQ,GAAUP,EAASO,EAAM,OAAO,KAAK,CAAA,CAAA,CAClD,EACF,EACAc,EAAAA,KAAC,QAAA,CAAM,UAAU,QACf,SAAA,CAAAD,EAAAA,IAAC,OAAA,CAAK,UAAU,gDAAgD,SAAA,WAAQ,EACxEA,EAAAA,IAAC,QAAA,CACC,aAAW,WACX,UAAU,0IACV,KAAK,WACL,aAAa,mBACb,MAAOlB,EACP,SAAWK,GAAUJ,EAAYI,EAAM,OAAO,KAAK,CAAA,CAAA,CACrD,EACF,EACCH,EAAQgB,EAAAA,IAAC,IAAA,CAAE,UAAU,wBAAyB,WAAM,EAAO,KAC5DA,EAAAA,IAAC,SAAA,CACC,UAAU,iHACV,KAAK,SACL,SAAUvB,EAAc,UAEvB,SAAAA,EAAc,UAAY,gBAAkB,SAAA,CAAA,CAC/C,EACF,EAEAwB,EAAAA,KAAC,MAAA,CAAI,UAAU,oCACb,SAAA,CAAAD,MAACE,EAAA,CAAK,UAAU,iCAAiC,GAAG,YAAY,SAAA,iBAEhE,QACCA,EAAA,CAAK,UAAU,iCAAiC,GAAG,mBAAmB,SAAA,kBAAA,CAEvE,CAAA,CAAA,CACF,CAAA,EACF,CAEJ"}